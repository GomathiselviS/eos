---
merged:
  commands:
    - router bgp 65535
    - address-family ipv4
    - redistribute ospf3 match external
    - network 1.1.1.0/24
    - network 1.5.1.0/24 route-map MAP01
    - neighbor 1.1.1.1 activate
    - exit
    - address-family ipv6
    - neighbor peer2 default-originate always
    - bgp additional-paths receive
    - exit
    - vrf vrft
    - address-family ipv6
    - redistribute isis level-2
    - route-target export 33:11
    - exit
    - exit

  after:
    address_family:
      - afi: "ipv4"
        redistribute:
          - protocol: "ospf3"
            ospf_route: "external"
        network:
          - address: "1.1.1.0/24"
          - address: "1.5.1.0/24"
            route_map: "MAP01"
        neighbor:
          - peer: "1.1.1.1"
            activate: True
      - afi: "ipv6"
        bgp_params:
          additional_paths: "receive"
        neighbor:
          - peer: "peer2"
            default_originate:
              always: True 
      - afi: "ipv6"
        vrf: "vrft"
        redistribute:
          - protocol: "isis"
            isis_level: "level-2"
        route_target:
          mode: "export"
          target: "33:11"

deleted:
  after:
    address_family:
      - afi: "ipv4"
        vrf: "vrft"
        bgp_params:
          additional_paths: "receive"

  commands:
    - router bgp 65535
    - no address-family ipv4
    - vrf vrft
    - no address-family ipv6

replaced:
  commands:
    - router bgp 65535
    - vrf vrft
    - address-family ipv4
    - redistribute ospf3 match external
    - exit
    - exit
    - address-family ipv4
    - redistribute isis level-2
    - no redistribute ospf3 match external
    - no network 1.1.1.0/24
    - no network 1.5.1.0/24 route-map MAP01
    - no neighbor peer2 default-originate always
    - no neighbor 1.1.1.1 activate
    - no bgp additional-paths receive
    - exit 
  before:
    address_family:
      - afi: "ipv4"
        redistribute:
          - protocol: "ospf3"
            ospf_route: "external"
        network:
          - address: "1.1.1.0/24"
          - address: "1.5.1.0/24"
            route_map: "MAP01"
        neighbor:
          - peer: "peer2"
            default_originate:
              always: true
          - peer: "1.1.1.1"
            activate: True
        bgp_params:
          additional_paths: "receive"
      - afi: "ipv6"
        vrf: "vrft"
        redistribute:
          - protocol: "isis"
            isis_level: "level-2"
      - afi: "ipv4"
        vrf: "vrft"
        bgp_params:
          additional_paths: "receive"
  after:
    address_family:
      - afi: "ipv4"
        redistribute:
          - protocol: "isis"
            isis_level: "level-2"
      - afi: "ipv6"
        vrf: "vrft"
        redistribute:
          - protocol: "isis"
            isis_level: "level-2"
      - afi: "ipv4"
        vrf: "vrft"
        redistribute:
          - protocol: "ospf3"
            ospf_route: "external"
        bgp_params:
          additional_paths: "receive"

overridden:
  commands:
    - router bgp 65535
    - vrf vrft
    - address-family ipv4
    - redistribute ospf3 match external
    - exit
    - exit
    - address-family ipv6
    - redistribute isis level-2
    - exit
    - no address-family ipv4
    - vrf vrft
    - no address-family ipv6

  after:
    address_family:
      - afi: "ipv4"
        vrf: "vrft"
        redistribute:
          - protocol: "ospf3"
            ospf_route: "external"
        bgp_params:
          additional_paths: "receive"
      - afi: "ipv6"
        redistribute:
          - protocol: "isis"
            isis_level: "level-2"
